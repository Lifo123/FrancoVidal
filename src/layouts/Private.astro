---
import Header from "@Components/Header.astro";
import Layout from "@Layouts/Layout.astro";

interface Props {
	title: string;
	description: string;
}
const { title, description } = Astro.props;
---

<script is:inline>
	const globalUser = JSON.parse(localStorage.getItem("FV-User") || "{}");

	if (!globalUser || Object.keys(globalUser).length === 0) {
		window.location.href = "/FrancoVidal/auth/login";
	}

	const currentPath = window.location.pathname;
	const userRole = globalUser.role || "clipero";

	const accessMap = {
		admin: ["/FrancoVidal/admin/","/FrancoVidal/controller/","/FrancoVidal/clipero/",],
		controller: ["/FrancoVidal/controller/", "/FrancoVidal/clipero/"],
		clipero: ["/FrancoVidal/clipero/"],
	};

	const allowedPaths = accessMap[userRole] || [];

	if (!allowedPaths.includes(currentPath)) {
		window.location.href = allowedPaths[0];
	}
</script>

<Layout title={title} description={description}>
	<Header />
	<slot />
</Layout>
